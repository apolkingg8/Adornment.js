{"version":3,"sources":["G:\\GitHub\\decorate_js\\src\\once.jsx"],"names":[],"mappings":";;;;;;;;uBAAoB,WAAW;;;;AAG/B,SAAS,WAAW,CAAC,MAAgB,EAAE;;AAEnC,yBAAQ,mBAAmB,CAAC,MAAM,EAAE,UAAS,GAAG,EAAE;;AAE9C,YAAG,OAAO,MAAM,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,UAAU,EAAE;AAC5C,gBAAI,UAAU,GAAG,MAAM,CAAC,wBAAwB,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,CAAC;gBACnE,MAAM,GAAG,qBAAQ,SAAS,CAAC,UAAU,CAAC,CAAA;;AAE1C,sBAAU,CAAC,KAAK,GAAG,YAAkB;kDAAN,IAAI;AAAJ,wBAAI;;;AAC/B,oBAAM,SAAS,cAAY,GAAG,AAAE,CAAA;;AAEhC,oBAAG,IAAI,CAAC,SAAS,CAAC,KAAK,IAAI,EAAE;AACzB,0BAAM,CAAC,cAAc,CAAC,IAAI,EAAE,SAAS,EAAE;AACnC,kCAAU,EAAE,KAAK;AACjB,oCAAY,EAAE,KAAK;AACnB,gCAAQ,EAAE,KAAK;AACf,6BAAK,EAAE,IAAI;qBACd,CAAC,CAAA;;AAEF,2BAAO,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;iBAClC,MAAM;;AAEH,2BAAO,IAAI,CAAA;iBACd;aACJ,CAAA;;AAED,kBAAM,CAAC,cAAc,CAAC,MAAM,CAAC,SAAS,EAAE,GAAG,EAAE,UAAU,CAAC,CAAA;SAC3D;KACJ,CAAC,CAAA;;AAEF,WAAO,MAAM,CAAA;CAChB;;AAED,SAAS,YAAY,CAAC,MAAgB,EAAE,GAAW,EAAE,UAAU,EAAE;AAC7D,QAAI,MAAM,GAAG,qBAAQ,SAAS,CAAC,UAAU,CAAC,CAAA;;AAE1C,cAAU,CAAC,KAAK,GAAG,YAAkB;2CAAN,IAAI;AAAJ,gBAAI;;;AAC/B,YAAM,SAAS,cAAY,GAAG,AAAE,CAAA;;AAEhC,YAAG,IAAI,CAAC,SAAS,CAAC,KAAK,IAAI,EAAE;AACzB,kBAAM,CAAC,cAAc,CAAC,IAAI,EAAE,SAAS,EAAE;AACnC,0BAAU,EAAE,KAAK;AACjB,4BAAY,EAAE,KAAK;AACnB,wBAAQ,EAAE,KAAK;AACf,qBAAK,EAAE,IAAI;aACd,CAAC,CAAA;;AAEF,mBAAO,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAA;SAClC,MAAM;;AAEH,mBAAO,IAAI,CAAA;SACd;KACJ,CAAA;;AAED,WAAO,UAAU,CAAA;CACpB;;AAED,SAAS,UAAU,CAAC,MAAgB,EAAE,GAAW,EAAE,UAAU,EAAE;AAC3D,WAAO,CAAC,IAAI,6CAA6C,CAAA;AACzD,WAAO,UAAU,CAAA;CACpB;;AAED,SAAS,IAAI,GAAU;uCAAN,IAAI;AAAJ,YAAI;;;AACjB,yBAAQ,OAAO,CAAC,IAAI,EAAE,IAAI,EAAE,WAAW,EAAE,YAAY,EAAE,UAAU,CAAC,CAAA;CACrE;;qBAEc,IAAI","file":"once.js","sourcesContent":["import Helpers from './_helper'\r\n\r\n\r\nfunction handleClass(target: Function) {\r\n\r\n    Helpers.forEachClassOwnKeys(target, function(key) {\r\n\r\n        if(typeof target.prototype[key] === \"function\") {\r\n            var descriptor = Object.getOwnPropertyDescriptor(target.prototype, key),\r\n                method = Helpers.getMethod(descriptor)\r\n\r\n            descriptor.value = function(...args) {\r\n                const cacheName = `_once_${key}`\r\n\r\n                if(this[cacheName] !== true) {\r\n                    Object.defineProperty(this, cacheName, {\r\n                        enumerable: false,\r\n                        configurable: false,\r\n                        writable: false,\r\n                        value: true\r\n                    })\r\n\r\n                    return method.apply(this, args)\r\n                } else {\r\n                    //console.warn(`@once ${key} already done.`)\r\n                    return null\r\n                }\r\n            }\r\n\r\n            Object.defineProperty(target.prototype, key, descriptor)\r\n        }\r\n    })\r\n\r\n    return target\r\n}\r\n\r\nfunction handleMethod(target: Function, key: String, descriptor) {\r\n    var method = Helpers.getMethod(descriptor)\r\n\r\n    descriptor.value = function(...args) {\r\n        const cacheName = `_once_${key}`\r\n\r\n        if(this[cacheName] !== true) {\r\n            Object.defineProperty(this, cacheName, {\r\n                enumerable: false,\r\n                configurable: false,\r\n                writable: false,\r\n                value: true\r\n            })\r\n\r\n            return method.apply(this, args)\r\n        } else {\r\n            //console.warn(`@once ${key} already done.`)\r\n            return null\r\n        }\r\n    }\r\n\r\n    return descriptor\r\n}\r\n\r\nfunction handleProp(target: Function, key: String, descriptor) {\r\n    console.warn(`@once should not set on class properties.`)\r\n    return descriptor\r\n}\r\n\r\nfunction once(...args) {\r\n    Helpers.handler(args, null, handleClass, handleMethod, handleProp)\r\n}\r\n\r\nexport default once"]}